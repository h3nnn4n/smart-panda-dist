(window["webpackJsonp"] = window["webpackJsonp"] || []).push([["index"],{

/***/ "./index.js":
/*!******************!*\
  !*** ./index.js ***!
  \******************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _js_draw_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./js/draw.js */ \"./js/draw.js\");\n/* harmony import */ var _js_random_agent_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./js/random_agent.js */ \"./js/random_agent.js\");\n/* harmony import */ var _js_learning_agent_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./js/learning_agent.js */ \"./js/learning_agent.js\");\n/* harmony import */ var _js_user_interface_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./js/user_interface.js */ \"./js/user_interface.js\");\nvar Rust;\n\n\n\n\nvar gamestate;\n\nvar renderLoop = function renderLoop() {\n  if (_js_user_interface_js__WEBPACK_IMPORTED_MODULE_3__[\"useRandomAgent\"]()) {\n    _js_random_agent_js__WEBPACK_IMPORTED_MODULE_1__[\"RandomAgent\"](gamestate);\n  } else if (_js_user_interface_js__WEBPACK_IMPORTED_MODULE_3__[\"useLearningAgent\"]()) {\n    _js_learning_agent_js__WEBPACK_IMPORTED_MODULE_2__[\"LearningAgent\"](gamestate);\n  }\n\n  gamestate.clear_lines();\n  _js_draw_js__WEBPACK_IMPORTED_MODULE_0__[\"draw\"]();\n  requestAnimationFrame(renderLoop);\n};\n\nvar init = function init() {\n  _js_user_interface_js__WEBPACK_IMPORTED_MODULE_3__[\"initInterface\"]();\n  gamestate = Rust.get_new_gamestate();\n  gamestate.set_board_size(10, 20);\n  _js_draw_js__WEBPACK_IMPORTED_MODULE_0__[\"initCanvas\"](gamestate);\n  requestAnimationFrame(renderLoop);\n};\n\n(function () {\n  return __webpack_require__.e(/*! import() | smart_panda */ \"smart_panda\").then(__webpack_require__.bind(null, /*! ./pkg/smart_panda */ \"./pkg/smart_panda.js\")).then(function (module) {\n    Rust = module;\n    init();\n  });\n})();\n\n//# sourceURL=webpack:///./index.js?");

/***/ }),

/***/ "./js/agent_state.js":
/*!***************************!*\
  !*** ./js/agent_state.js ***!
  \***************************/
/*! exports provided: AgentState */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AgentState\", function() { return AgentState; });\nvar enumValue = function enumValue(name) {\n  return Object.freeze({\n    toString: function toString() {\n      return name;\n    }\n  });\n};\n\nvar AgentState = Object.freeze({\n  GAMEOVER: enumValue(\"AgentState.GAMEOVER\"),\n  LEARN: enumValue(\"AgentState.LEARN\"),\n  SPAWN: enumValue(\"AgentState.SPAWN\"),\n  GAMESTART: enumValue(\"AgentState.GAMESTART\"),\n  FIND_AND_PLACE: enumValue(\"AgentState.FIND_AND_PLACE\")\n});\n\n//# sourceURL=webpack:///./js/agent_state.js?");

/***/ }),

/***/ "./js/board.js":
/*!*********************!*\
  !*** ./js/board.js ***!
  \*********************/
/*! exports provided: store_board, load_board */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"store_board\", function() { return store_board; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"load_board\", function() { return load_board; });\nvar wasm_module;\n\n(function () {\n  return __webpack_require__.e(/*! import() | smart_panda_bg */ \"smart_panda\").then(__webpack_require__.bind(null, /*! ../pkg/smart_panda_bg */ \"./pkg/smart_panda_bg.wasm\")).then(function (module) {\n    wasm_module = module;\n  });\n})();\n\nvar active_piece;\nvar board_pointer;\nvar board_data;\n\nvar build_memory_buffer = function build_memory_buffer(cellsPtr, length) {\n  return new Uint32Array(wasm_module.memory.buffer, cellsPtr, length);\n};\n\nvar get_board_pointer = function get_board_pointer(gamestate) {\n  var cellsPtr = gamestate.get_board_pointer();\n  var width = gamestate.get_width();\n  var height = gamestate.get_height();\n  return build_memory_buffer(cellsPtr, width * height);\n};\n\nfunction store_board(gamestate) {\n  board_pointer = get_board_pointer(gamestate);\n  board_data = new Uint32Array(board_pointer);\n\n  if (gamestate.has_active_piece()) {\n    active_piece = gamestate.get_active_piece();\n  }\n}\nfunction load_board(gamestate) {\n  set_board(board_pointer, board_data);\n  gamestate.build_active_piece(active_piece.get_id(), active_piece.get_x(), active_piece.get_y(), active_piece.get_rotation());\n  store_board(gamestate);\n}\n\nvar set_board = function set_board(board_pointer, board_data) {\n  for (var index = 0; index < board_pointer.length; index++) {\n    board_pointer[index] = board_data[index];\n  }\n};\n\n//# sourceURL=webpack:///./js/board.js?");

/***/ }),

/***/ "./js/brain.js":
/*!*********************!*\
  !*** ./js/brain.js ***!
  \*********************/
/*! exports provided: game_over_tick, get_best_feature_weights, get_current_feature_weights, get_current_mean, get_best_mean, get_best_lines_cleared */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"game_over_tick\", function() { return game_over_tick; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"get_best_feature_weights\", function() { return get_best_feature_weights; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"get_current_feature_weights\", function() { return get_current_feature_weights; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"get_current_mean\", function() { return get_current_mean; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"get_best_mean\", function() { return get_best_mean; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"get_best_lines_cleared\", function() { return get_best_lines_cleared; });\n/* harmony import */ var _brains_monte_carlo_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./brains/monte_carlo.js */ \"./js/brains/monte_carlo.js\");\n\nvar brain = _brains_monte_carlo_js__WEBPACK_IMPORTED_MODULE_0__;\nvar game_over_tick = function game_over_tick(gamestate) {\n  brain.game_over_tick(gamestate);\n};\nvar get_best_feature_weights = function get_best_feature_weights() {\n  return brain.get_best_feature_weights();\n};\nvar get_current_feature_weights = function get_current_feature_weights() {\n  return brain.get_current_feature_weights();\n};\nvar get_current_mean = function get_current_mean() {\n  return brain.get_current_mean();\n};\nvar get_best_mean = function get_best_mean() {\n  return brain.get_best_mean();\n};\nvar get_best_lines_cleared = function get_best_lines_cleared() {\n  return brain.get_best_lines_cleared();\n};\n\n//# sourceURL=webpack:///./js/brain.js?");

/***/ }),

/***/ "./js/brains/monte_carlo.js":
/*!**********************************!*\
  !*** ./js/brains/monte_carlo.js ***!
  \**********************************/
/*! exports provided: game_over_tick, get_best_feature_weights, get_current_feature_weights, get_best_lines_cleared, get_current_mean, get_best_mean */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"game_over_tick\", function() { return game_over_tick; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"get_best_feature_weights\", function() { return get_best_feature_weights; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"get_current_feature_weights\", function() { return get_current_feature_weights; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"get_best_lines_cleared\", function() { return get_best_lines_cleared; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"get_current_mean\", function() { return get_current_mean; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"get_best_mean\", function() { return get_best_mean; });\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../utils */ \"./js/utils.js\");\n/* harmony import */ var _feature_functions__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../feature_functions */ \"./js/feature_functions.js\");\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance\"); }\n\nfunction _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }\n\n\n\nvar temperature = 1.0;\nvar total_samples = 10;\nvar best_lines_cleared = 0;\nvar scores = [];\nvar feature_weights = [];\nvar trial_feature_weights = [];\nvar trial_scores = [];\nvar trial_samples_left = total_samples;\nfunction game_over_tick(gamestate) {\n  update_best_lines_cleared(gamestate);\n  trial_scores.push(gamestate.get_lines_cleared());\n\n  if (tick_samples()) {\n    learn();\n  }\n}\nfunction get_best_feature_weights() {\n  return feature_weights;\n}\nfunction get_current_feature_weights() {\n  return trial_feature_weights;\n}\nvar get_best_lines_cleared = function get_best_lines_cleared() {\n  return best_lines_cleared;\n};\nvar get_current_mean = function get_current_mean() {\n  return Object(_utils__WEBPACK_IMPORTED_MODULE_0__[\"mean\"])(trial_scores);\n};\nvar get_best_mean = function get_best_mean() {\n  return Object(_utils__WEBPACK_IMPORTED_MODULE_0__[\"mean\"])(scores);\n};\n\nvar update_best_lines_cleared = function update_best_lines_cleared(gamestate) {\n  best_lines_cleared = Math.max(best_lines_cleared, gamestate.get_lines_cleared());\n};\n\nvar learn = function learn() {\n  // learn_monte_carlo();\n  learn_greedy();\n  trial_scores = [];\n  perturbate_trial_feature_weights();\n};\n\nvar learn_greedy = function learn_greedy() {\n  if (Object(_utils__WEBPACK_IMPORTED_MODULE_0__[\"mean\"])(trial_scores) > Object(_utils__WEBPACK_IMPORTED_MODULE_0__[\"mean\"])(scores)) {\n    feature_weights = _toConsumableArray(trial_feature_weights);\n    scores = _toConsumableArray(trial_scores);\n  }\n};\n\nvar learn_monte_carlo = function learn_monte_carlo() {\n  if (Object(_utils__WEBPACK_IMPORTED_MODULE_0__[\"mean\"])(trial_scores) > Object(_utils__WEBPACK_IMPORTED_MODULE_0__[\"mean\"])(scores)) {\n    feature_weights = _toConsumableArray(trial_feature_weights);\n    scores = _toConsumableArray(trial_scores);\n  } else {\n    var delta_energy = Object(_utils__WEBPACK_IMPORTED_MODULE_0__[\"mean\"])(scores) - Object(_utils__WEBPACK_IMPORTED_MODULE_0__[\"mean\"])(trial_scores);\n\n    if (Math.exp(-delta_energy / temperature) >= Math.random()) {\n      feature_weights = _toConsumableArray(trial_feature_weights);\n      scores = _toConsumableArray(trial_scores);\n    }\n  }\n};\n\nvar perturbate_trial_feature_weights = function perturbate_trial_feature_weights() {\n  if (Object(_utils__WEBPACK_IMPORTED_MODULE_0__[\"mean\"])(scores) <= 4 || Math.random() < 0.1) {\n    trial_feature_weights = random_feature_weights();\n  } else {\n    if (Math.random() < 0.5) {\n      trial_feature_weights = perturbate_from_best_feature_weights();\n    } else {\n      trial_feature_weights = perturbate_one_variable_from_best_feature_weights();\n    }\n  }\n};\n/**\n * Update the samples left for the current feature_function under evaluation\n * @returns {boolean} True if the tick finished all evaluations\n */\n\n\nvar tick_samples = function tick_samples() {\n  trial_samples_left -= 1;\n\n  if (trial_samples_left < 0 || Object(_utils__WEBPACK_IMPORTED_MODULE_0__[\"mean\"])(trial_scores) <= 5 || Object(_utils__WEBPACK_IMPORTED_MODULE_0__[\"mean\"])(trial_scores) < Object(_utils__WEBPACK_IMPORTED_MODULE_0__[\"mean\"])(scores) / 2 && trial_scores.length > 3) {\n    trial_samples_left = total_samples;\n    return true;\n  }\n\n  return false;\n};\n\nvar random_feature_weights = function random_feature_weights() {\n  var weights = [];\n\n  for (var index = 0; index < Object(_feature_functions__WEBPACK_IMPORTED_MODULE_1__[\"number_of_features\"])(); index++) {\n    weights.push(Object(_utils__WEBPACK_IMPORTED_MODULE_0__[\"rand_float\"])(-5, 5));\n  }\n\n  return weights;\n};\n\nvar perturbate_from_best_feature_weights = function perturbate_from_best_feature_weights() {\n  var magnitude = 1;\n\n  for (var index = 0; index < Object(_feature_functions__WEBPACK_IMPORTED_MODULE_1__[\"number_of_features\"])(); index++) {\n    trial_feature_weights[index] = feature_weights[index] + Object(_utils__WEBPACK_IMPORTED_MODULE_0__[\"rand_float\"])(-magnitude, magnitude);\n  }\n\n  return trial_feature_weights;\n};\n\nvar perturbate_one_variable_from_best_feature_weights = function perturbate_one_variable_from_best_feature_weights() {\n  var magnitude = 1;\n  var index = Object(_utils__WEBPACK_IMPORTED_MODULE_0__[\"rand_int\"])(0, trial_feature_weights.length - 1);\n  trial_feature_weights[index] = feature_weights[index] + Object(_utils__WEBPACK_IMPORTED_MODULE_0__[\"rand_float\"])(-magnitude, magnitude);\n  return trial_feature_weights;\n};\n\nvar initialize = function initialize() {\n  trial_feature_weights = random_feature_weights();\n  feature_weights = random_feature_weights();\n  scores = [0];\n};\n\ninitialize();\n\n//# sourceURL=webpack:///./js/brains/monte_carlo.js?");

/***/ }),

/***/ "./js/draw.js":
/*!********************!*\
  !*** ./js/draw.js ***!
  \********************/
/*! exports provided: initCanvas, draw */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"initCanvas\", function() { return initCanvas; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"draw\", function() { return draw; });\n/* harmony import */ var _feature_functions_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./feature_functions.js */ \"./js/feature_functions.js\");\n/* harmony import */ var _game_score_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./game_score.js */ \"./js/game_score.js\");\n/* harmony import */ var _fps_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./fps.js */ \"./js/fps.js\");\n\n\n\nvar wasm_module;\n\n(function () {\n  return __webpack_require__.e(/*! import() | smart_panda_bg */ \"smart_panda\").then(__webpack_require__.bind(null, /*! ../pkg/smart_panda_bg */ \"./pkg/smart_panda_bg.wasm\")).then(function (module) {\n    wasm_module = module;\n  });\n})();\n\nvar CELL_SIZE = 10; // px\n\nvar GRID_COLOR = \"#CCCCCC\";\nvar DEAD_COLOR = \"#FFFFFF\";\nvar ACTIVE_COLOR = \"#BA946A\";\nvar PLACED_COLOR = \"#000000\";\nvar gamestate;\nvar width;\nvar height;\nvar canvas = document.getElementById(\"tetris-canvas\");\nvar ctx = canvas.getContext('2d');\n\nvar getIndex = function getIndex(row, column) {\n  return column * height + row;\n};\n\nfunction initCanvas(gamestate_) {\n  gamestate = gamestate_;\n  width = gamestate.get_width();\n  height = gamestate.get_height();\n  canvas.height = (CELL_SIZE + 1) * height + 2;\n  canvas.width = (CELL_SIZE + 1) * width + 2;\n}\n\nfunction drawGrid() {\n  ctx.lineWidth = 1.0;\n  ctx.beginPath();\n  ctx.strokeStyle = GRID_COLOR;\n\n  for (var i = 0; i <= width; i++) {\n    ctx.moveTo(i * (CELL_SIZE + 1) + 1, 0);\n    ctx.lineTo(i * (CELL_SIZE + 1) + 1, (CELL_SIZE + 1) * height + 1);\n  }\n\n  for (var j = 0; j <= height; j++) {\n    ctx.moveTo(0, j * (CELL_SIZE + 1) + 1);\n    ctx.lineTo((CELL_SIZE + 1) * width + 1, j * (CELL_SIZE + 1) + 1);\n  }\n\n  ctx.stroke();\n}\n\nfunction drawCells() {\n  var cellsPtr = gamestate.get_board_pointer();\n  var cells = new Uint32Array(wasm_module.memory.buffer, cellsPtr, width * height);\n  ctx.beginPath();\n\n  for (var row = 0; row < height; row++) {\n    for (var col = 0; col < width; col++) {\n      var idx = getIndex(row, col);\n\n      switch (cells[idx]) {\n        case 0:\n          ctx.fillStyle = DEAD_COLOR;\n          break;\n\n        default:\n          if (cells[idx] > 10) {\n            ctx.fillStyle = ACTIVE_COLOR;\n          } else {\n            ctx.fillStyle = PLACED_COLOR;\n          }\n\n      }\n\n      ctx.fillRect(col * (CELL_SIZE + 1) + 1, row * (CELL_SIZE + 1) + 1, CELL_SIZE, CELL_SIZE);\n    }\n  }\n\n  ctx.stroke();\n}\n\nfunction drawGameOver() {\n  ctx.fillStyle = \"White\";\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\n  ctx.fillStyle = \"Black\";\n  ctx.font = \"18px Arial\";\n  ctx.textAlign = \"center\";\n  ctx.fillText(\"Game Over\", canvas.width / 2, canvas.height / 2);\n}\n\nfunction draw() {\n  if (gamestate.is_game_over()) {\n    drawGameOver();\n  } else {\n    ctx.clearRect(0, 0, canvas.width, canvas.height);\n    drawGrid();\n    drawCells();\n    _fps_js__WEBPACK_IMPORTED_MODULE_2__[\"fps\"].render();\n    _feature_functions_js__WEBPACK_IMPORTED_MODULE_0__[\"drawFeatures\"](gamestate);\n    _game_score_js__WEBPACK_IMPORTED_MODULE_1__[\"drawScore\"](gamestate);\n  }\n}\n\n//# sourceURL=webpack:///./js/draw.js?");

/***/ }),

/***/ "./js/feature_functions.js":
/*!*********************************!*\
  !*** ./js/feature_functions.js ***!
  \*********************************/
/*! exports provided: number_of_features, drawFeatures, get_board_score */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"number_of_features\", function() { return number_of_features; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"drawFeatures\", function() { return drawFeatures; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"get_board_score\", function() { return get_board_score; });\n/* harmony import */ var sprintf_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! sprintf-js */ \"./node_modules/sprintf-js/src/sprintf.js\");\n/* harmony import */ var sprintf_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(sprintf_js__WEBPACK_IMPORTED_MODULE_0__);\n\nvar feature_functions = [function (a) {\n  return a.get_aggregate_height();\n}, function (a) {\n  return a.get_surface_variance();\n}, function (a) {\n  return a.get_number_of_holes();\n}, function (a) {\n  return a.get_delta_height();\n}, function (a) {\n  return a.get_covered_cells();\n}, function (a) {\n  return a.get_vertical_roughness();\n}];\nvar number_of_features = function number_of_features() {\n  return feature_functions.length;\n};\nfunction drawFeatures(gamestate) {\n  var feature_function_area = document.getElementById(\"feature-functions\");\n  var feature_string = \"\";\n  feature_string += sprintf_js__WEBPACK_IMPORTED_MODULE_0__[\"sprintf\"](\"  aggregate_height: %3d\\n\", gamestate.get_aggregate_height());\n  feature_string += sprintf_js__WEBPACK_IMPORTED_MODULE_0__[\"sprintf\"](\"  surface_variance: %3d\\n\", gamestate.get_surface_variance());\n  feature_string += sprintf_js__WEBPACK_IMPORTED_MODULE_0__[\"sprintf\"](\"   number_of_holes: %3d\\n\", gamestate.get_number_of_holes());\n  feature_string += sprintf_js__WEBPACK_IMPORTED_MODULE_0__[\"sprintf\"](\"      delta_height: %3d\\n\", gamestate.get_delta_height());\n  feature_string += sprintf_js__WEBPACK_IMPORTED_MODULE_0__[\"sprintf\"](\"     covered_cells: %3d\\n\", gamestate.get_covered_cells());\n  feature_string += sprintf_js__WEBPACK_IMPORTED_MODULE_0__[\"sprintf\"](\"vertical_roughness: %3d\\n\", gamestate.get_vertical_roughness());\n  feature_function_area.textContent = feature_string;\n}\nfunction get_board_score(gamestate, feature_weights) {\n  var board_score = 0;\n  var features_scores = feature_functions.map(function (f) {\n    return f(gamestate);\n  });\n\n  for (var index = 0; index < feature_weights.length; index++) {\n    var weight = feature_weights[index];\n    var score = features_scores[index];\n    board_score += weight * score;\n  }\n\n  return board_score;\n}\n\n//# sourceURL=webpack:///./js/feature_functions.js?");

/***/ }),

/***/ "./js/fps.js":
/*!*******************!*\
  !*** ./js/fps.js ***!
  \*******************/
/*! exports provided: fps */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"fps\", function() { return fps; });\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\n/*jshint esversion: 6 */\n// Stolen from some tutorial rust/wasm tutorial\nvar fps = new (\n/*#__PURE__*/\nfunction () {\n  function _class() {\n    _classCallCheck(this, _class);\n\n    this.fps = document.getElementById(\"fps\");\n    this.frames = [];\n    this.lastFrameTimeStamp = performance.now();\n  }\n\n  _createClass(_class, [{\n    key: \"render\",\n    value: function render() {\n      if (!this.fps) {\n        return;\n      }\n\n      var now = performance.now();\n      var delta = now - this.lastFrameTimeStamp;\n      this.lastFrameTimeStamp = now;\n      var fps = 1 / delta * 1000;\n      this.frames.push(fps);\n\n      if (this.frames.length > 100) {\n        this.frames.shift();\n      }\n\n      var min = Infinity;\n      var max = -Infinity;\n      var sum = 0;\n\n      for (var i = 0; i < this.frames.length; i++) {\n        sum += this.frames[i];\n        min = Math.min(this.frames[i], min);\n        max = Math.max(this.frames[i], max);\n      }\n\n      var mean = sum / this.frames.length;\n      this.fps.textContent = \"\\nFrames per Second:\\n         latest = \".concat(Math.round(fps), \"\\navg of last 100 = \").concat(Math.round(mean), \"\\nmin of last 100 = \").concat(Math.round(min), \"\\nmax of last 100 = \").concat(Math.round(max), \"\\n\").trim();\n    }\n  }]);\n\n  return _class;\n}())();\n\n//# sourceURL=webpack:///./js/fps.js?");

/***/ }),

/***/ "./js/game_score.js":
/*!**************************!*\
  !*** ./js/game_score.js ***!
  \**************************/
/*! exports provided: drawScore */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"drawScore\", function() { return drawScore; });\n/* harmony import */ var sprintf_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! sprintf-js */ \"./node_modules/sprintf-js/src/sprintf.js\");\n/* harmony import */ var sprintf_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(sprintf_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _brain_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./brain.js */ \"./js/brain.js\");\n\n\nfunction drawScore(gamestate) {\n  var score_area = document.getElementById(\"score\");\n  var score_string = \"\"; // score_string += Print.sprintf(\"        score: %3d\\n\", gamestate.get_points());\n\n  score_string += sprintf_js__WEBPACK_IMPORTED_MODULE_0__[\"sprintf\"](\"lines_cleared: %3d\\n\", gamestate.get_lines_cleared());\n  score_string += sprintf_js__WEBPACK_IMPORTED_MODULE_0__[\"sprintf\"](\"         best: %3d\\n\", _brain_js__WEBPACK_IMPORTED_MODULE_1__[\"get_best_lines_cleared\"]());\n  score_string += sprintf_js__WEBPACK_IMPORTED_MODULE_0__[\"sprintf\"](\"    best_mean: %6.2f\\n\", _brain_js__WEBPACK_IMPORTED_MODULE_1__[\"get_best_mean\"]());\n  score_string += sprintf_js__WEBPACK_IMPORTED_MODULE_0__[\"sprintf\"](\" current_mean: %6.2f\\n\", _brain_js__WEBPACK_IMPORTED_MODULE_1__[\"get_current_mean\"]());\n  score_string += get_best_weight_string();\n  score_string += get_current_weight_string();\n  score_area.textContent = score_string;\n}\n\nvar get_current_weight_string = function get_current_weight_string() {\n  var weights = _brain_js__WEBPACK_IMPORTED_MODULE_1__[\"get_current_feature_weights\"]();\n  var weight_string = \"\\n\";\n  weights.forEach(function (weight) {\n    weight_string += sprintf_js__WEBPACK_IMPORTED_MODULE_0__[\"sprintf\"](\"%6.2f \", weight);\n  });\n  return weight_string;\n};\n\nvar get_best_weight_string = function get_best_weight_string() {\n  var weights = _brain_js__WEBPACK_IMPORTED_MODULE_1__[\"get_best_feature_weights\"]();\n  var weight_string = \"\\n\";\n  weights.forEach(function (weight) {\n    weight_string += sprintf_js__WEBPACK_IMPORTED_MODULE_0__[\"sprintf\"](\"%6.2f \", weight);\n  });\n  return weight_string;\n};\n\n//# sourceURL=webpack:///./js/game_score.js?");

/***/ }),

/***/ "./js/learning_agent.js":
/*!******************************!*\
  !*** ./js/learning_agent.js ***!
  \******************************/
/*! exports provided: LearningAgent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"LearningAgent\", function() { return LearningAgent; });\n/* harmony import */ var _board_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./board.js */ \"./js/board.js\");\n/* harmony import */ var _brain_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./brain.js */ \"./js/brain.js\");\n/* harmony import */ var _utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./utils */ \"./js/utils.js\");\n/* harmony import */ var _feature_functions_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./feature_functions.js */ \"./js/feature_functions.js\");\n/* harmony import */ var _agent_state_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./agent_state.js */ \"./js/agent_state.js\");\n\n\n\n\n\nvar currentState = _agent_state_js__WEBPACK_IMPORTED_MODULE_4__[\"AgentState\"].GAMESTART;\nvar todo_rotation;\nvar todo_lateral_move;\nfunction LearningAgent(gamestate) {\n  switch (currentState) {\n    case _agent_state_js__WEBPACK_IMPORTED_MODULE_4__[\"AgentState\"].GAMEOVER:\n      game_over_state(gamestate);\n      break;\n\n    case _agent_state_js__WEBPACK_IMPORTED_MODULE_4__[\"AgentState\"].GAMESTART:\n      game_start_state(gamestate);\n      break;\n\n    case _agent_state_js__WEBPACK_IMPORTED_MODULE_4__[\"AgentState\"].SPAWN:\n      spawn(gamestate);\n      break;\n\n    case _agent_state_js__WEBPACK_IMPORTED_MODULE_4__[\"AgentState\"].FIND_AND_PLACE:\n      find_and_place(gamestate);\n      break;\n  }\n}\n\nvar game_over_state = function game_over_state(gamestate) {\n  _brain_js__WEBPACK_IMPORTED_MODULE_1__[\"game_over_tick\"](gamestate);\n  currentState = _agent_state_js__WEBPACK_IMPORTED_MODULE_4__[\"AgentState\"].GAMESTART;\n};\n\nvar game_start_state = function game_start_state(gamestate) {\n  gamestate.reset();\n  currentState = _agent_state_js__WEBPACK_IMPORTED_MODULE_4__[\"AgentState\"].SPAWN;\n  gamestate.set_game_over(false);\n};\n\nvar spawn = function spawn(gamestate) {\n  if (gamestate.spawn_random_piece()) {\n    currentState = _agent_state_js__WEBPACK_IMPORTED_MODULE_4__[\"AgentState\"].FIND_AND_PLACE;\n  } else {\n    gamestate.set_game_over(true);\n    currentState = _agent_state_js__WEBPACK_IMPORTED_MODULE_4__[\"AgentState\"].GAMEOVER;\n  }\n};\n\nvar find_and_place = function find_and_place(gamestate) {\n  find_best_place(gamestate);\n  rotate(gamestate);\n  move(gamestate);\n  place(gamestate);\n  currentState = _agent_state_js__WEBPACK_IMPORTED_MODULE_4__[\"AgentState\"].SPAWN;\n};\n\nvar find_best_place = function find_best_place(gamestate) {\n  _board_js__WEBPACK_IMPORTED_MODULE_0__[\"store_board\"](gamestate);\n  var best_rotation;\n  var best_position;\n  var best_score = -Infinity;\n  var shuffled_positions = Object(_utils__WEBPACK_IMPORTED_MODULE_2__[\"suffled_array\"])(6, 13);\n\n  for (var i = 0; i < shuffled_positions.length; i++) {\n    var position = shuffled_positions[i];\n\n    for (var rotation = 0; rotation < 4; rotation++) {\n      todo_rotation = rotation;\n      todo_lateral_move = position;\n      rotate(gamestate);\n      move(gamestate);\n      place(gamestate);\n      var score = Object(_feature_functions_js__WEBPACK_IMPORTED_MODULE_3__[\"get_board_score\"])(gamestate, _brain_js__WEBPACK_IMPORTED_MODULE_1__[\"get_current_feature_weights\"]());\n\n      if (score > best_score) {\n        best_rotation = rotation;\n        best_position = position;\n        best_score = score;\n      }\n\n      _board_js__WEBPACK_IMPORTED_MODULE_0__[\"load_board\"](gamestate);\n    }\n  }\n\n  todo_rotation = best_rotation;\n  todo_lateral_move = best_position;\n};\n\nvar rotate = function rotate(gamestate) {\n  if (todo_rotation > 0) {\n    while (todo_rotation > 0) {\n      todo_rotation -= 1;\n      gamestate.rotate_active_piece_right();\n    }\n  }\n};\n\nvar move = function move(gamestate) {\n  if (todo_lateral_move > 0) {\n    while (todo_lateral_move > 0) {\n      todo_lateral_move -= 1;\n      gamestate.move_active_piece_left();\n    }\n  } else if (todo_lateral_move < 0) {\n    while (todo_lateral_move < 0) {\n      todo_lateral_move += 1;\n      gamestate.move_active_piece_right();\n    }\n  }\n};\n\nvar place = function place(gamestate) {\n  while (gamestate.move_active_piece_down_and_try_sleep()) {}\n};\n\n//# sourceURL=webpack:///./js/learning_agent.js?");

/***/ }),

/***/ "./js/random_agent.js":
/*!****************************!*\
  !*** ./js/random_agent.js ***!
  \****************************/
/*! exports provided: RandomAgent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"RandomAgent\", function() { return RandomAgent; });\nvar enumValue = function enumValue(name) {\n  return Object.freeze({\n    toString: function toString() {\n      return name;\n    }\n  });\n};\n\nvar AgentState = Object.freeze({\n  GAMEOVER: enumValue(\"AgentState.GAMEOVER\"),\n  GAMESTART: enumValue(\"AgentState.GAMESTART\"),\n  SPAWN: enumValue(\"AgentState.SPAWN\"),\n  ROTATE: enumValue(\"AgentState.ROTATE\"),\n  MOVE_RIGHT: enumValue(\"AgentState.MOVE_RIGHT\"),\n  MOVE_LEFT: enumValue(\"AgentState.MOVE_LEFT\"),\n  MOVE_DOWN: enumValue(\"AgentState.MOVE_DOWN\")\n});\nvar currentState = AgentState.GAMESTART;\nvar gameOverCounter = 60;\nvar gameOverFrames = 90;\nfunction RandomAgent(gamestate) {\n  switch (currentState) {\n    case AgentState.GAMEOVER:\n      if (gameOverCounter > 0) {\n        gameOverCounter -= 1;\n      } else {\n        gameOverCounter = gameOverFrames;\n        currentState = AgentState.GAMESTART;\n      }\n\n      break;\n\n    case AgentState.GAMESTART:\n      gamestate.reset();\n      currentState = AgentState.SPAWN;\n      gamestate.set_game_over(false);\n      break;\n\n    case AgentState.SPAWN:\n      if (gamestate.spawn_random_piece()) {\n        currentState = AgentState.ROTATE;\n      } else {\n        gamestate.set_game_over(true);\n        currentState = AgentState.GAMEOVER;\n      }\n\n      break;\n\n    case AgentState.ROTATE:\n      if (Math.random() < 0.33) {\n        gamestate.rotate_active_piece_right();\n      } else {\n        if (Math.random() < 0.5) {\n          currentState = AgentState.MOVE_RIGHT;\n        } else {\n          currentState = AgentState.MOVE_LEFT;\n        }\n      }\n\n      break;\n\n    case AgentState.MOVE_RIGHT:\n      if (Math.random() < 0.75) {\n        gamestate.move_active_piece_right();\n      } else {\n        currentState = AgentState.MOVE_DOWN;\n      }\n\n      break;\n\n    case AgentState.MOVE_LEFT:\n      if (Math.random() < 0.75) {\n        gamestate.move_active_piece_left();\n      } else {\n        currentState = AgentState.MOVE_DOWN;\n      }\n\n      break;\n\n    case AgentState.MOVE_DOWN:\n      if (!gamestate.move_active_piece_down_and_try_sleep()) {\n        currentState = AgentState.SPAWN;\n      }\n\n      break;\n\n    default:\n  }\n}\n\n//# sourceURL=webpack:///./js/random_agent.js?");

/***/ }),

/***/ "./js/user_interface.js":
/*!******************************!*\
  !*** ./js/user_interface.js ***!
  \******************************/
/*! exports provided: initInterface, useRandomAgent, useLearningAgent */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"initInterface\", function() { return initInterface; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"useRandomAgent\", function() { return useRandomAgent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"useLearningAgent\", function() { return useLearningAgent; });\n/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jquery */ \"./node_modules/jquery/dist/jquery.js\");\n/* harmony import */ var jquery__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(jquery__WEBPACK_IMPORTED_MODULE_0__);\n\nvar current_agent_mode;\n\nfunction radio_mode_change_event() {\n  var checked_radio = jquery__WEBPACK_IMPORTED_MODULE_0___default()(\"input[name='agent-mode']:checked\");\n  var unchecked_radio = jquery__WEBPACK_IMPORTED_MODULE_0___default()(\"input[name='agent-mode']\").not(':checked');\n  var new_agent_mode = checked_radio.val();\n\n  if (current_agent_mode != new_agent_mode) {// Stuff\n  }\n\n  current_agent_mode = new_agent_mode;\n  checked_radio.parent().addClass('active');\n  unchecked_radio.parent().removeClass('active');\n}\n\nfunction initInterface() {\n  var $radio_mode = jquery__WEBPACK_IMPORTED_MODULE_0___default()(\"input[name='agent-mode']\");\n  $radio_mode.click(radio_mode_change_event);\n  radio_mode_change_event();\n}\nfunction useRandomAgent() {\n  return current_agent_mode == 'random';\n}\nfunction useLearningAgent() {\n  return current_agent_mode == 'learning';\n}\n\n//# sourceURL=webpack:///./js/user_interface.js?");

/***/ }),

/***/ "./js/utils.js":
/*!*********************!*\
  !*** ./js/utils.js ***!
  \*********************/
/*! exports provided: shuffle_array, suffled_array, mean, rand_float, rand_int */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"shuffle_array\", function() { return shuffle_array; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"suffled_array\", function() { return suffled_array; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"mean\", function() { return mean; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"rand_float\", function() { return rand_float; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"rand_int\", function() { return rand_int; });\nvar shuffle_array = function shuffle_array(array) {\n  for (var i = array.length - 1; i > 0; i--) {\n    var j = Math.floor(Math.random() * (i + 1));\n    var temp = array[i];\n    array[i] = array[j];\n    array[j] = temp;\n  }\n\n  return array;\n};\nvar suffled_array = function suffled_array(start, length) {\n  var array = Array.from({\n    length: length\n  }).map(function (_, index) {\n    return index - start;\n  });\n  shuffle_array(array);\n  return array;\n};\nvar mean = function mean(values) {\n  if (!values || values.length === 0) {\n    return 0;\n  }\n\n  var sum = values.reduce(function (previous, current) {\n    return current += previous;\n  });\n  var avg = sum / values.length;\n  return avg;\n};\nvar rand_float = function rand_float(min, max) {\n  return Math.random() * (max - min) + min;\n};\nvar rand_int = function rand_int(minimum, maximum) {\n  return Math.floor(Math.random() * (maximum - minimum)) + minimum;\n};\n\n//# sourceURL=webpack:///./js/utils.js?");

/***/ })

}]);